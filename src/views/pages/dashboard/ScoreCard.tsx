import { useEffect, useRef, useState } from "react";
import { gsap } from "gsap";

interface ScoreCardItemProps {
  title: string;
  value: number;
  color: string;
  border:string;
  icon: JSX.Element;
}

export const ScoreCard = () => (
  <div className="grid lg:grid-cols-4 grid-cols-1 gap-5 pt-10">
    <ScoreCardItem
      title="Jumlah Semua Produk"
      value={3000}
      color="text-blue-500"
      border="border-blue-500"
      icon={<ProductIcon />}
    />
    <ScoreCardItem
      title="Jumlah Pesanan"
      value={2000}
      color="text-yellow-500"
      border="border-yellow-500"
      icon={<CountIcon />}
    />
    <ScoreCardItem
      title="Jumlah Retail"
      value={10000}
      color="text-red-500"
      border="border-red-500"
      icon={<RetailIcon />}
    />
    <ScoreCardItem
      title="Pendapatan Bulan ini"
      value={12000}
      color="text-green-500"
      border="border-green-500"
      icon={<Count />}
    />
  </div>
);

export const toRupiah = (n: number) =>
  `RpÂ ${n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".")}`;

const ScoreCardItem = ({ title, value, color, icon,border }: ScoreCardItemProps) => {
  const counterRef = useRef<HTMLSpanElement>(null);
  const [count, setCount] = useState(0);

  useEffect(() => {
    gsap.to(counterRef.current, {
      duration: 0.8,
      onUpdate() {
        const progress = this.progress();
        setCount(Math.ceil(progress * value));
      },
    });
  }, [value]);

  const getFontSizeClass = (num: number) => {
    const digit = num.toString().replace(/\D/g, "").length;

    if (digit <= 3) return "text-4xl";
    if (digit <= 6) return "text-3xl";
    if (digit <= 9) return "text-xl";
    if (digit <= 12) return "text-lg";
    if (digit <= 15) return "text-sm";
    return "text-xs";
  };

  const plainNumber = count;
  const fontSize = getFontSizeClass(plainNumber);

  const displayValue = title.toLowerCase().includes("pendapatan")
    ? toRupiah(count)
    : count;

  const textColor = `${color}`;
  const bgColor = `${color}`;

  return (
    <div className={`bg-white rounded-xl shadow p-4 flex flex-col gap-3 hover:border ${border} hover:scale-105 transition-all ease-in-out duration-100`}>
      <div className="flex items-center justify-between">
        <span
          ref={counterRef}
          className={`font-bold ${fontSize} leading-none ${textColor}`}
        >
          {displayValue}
        </span>

        <div className={`p-2 rounded-lg ${bgColor}/10`}>{icon}</div>
      </div>

      <h2 className="pt-3 text-lg font-medium text-slate-500">{title}</h2>
    </div>
  );
};

const ProductIcon = () => (
  <svg
    width="42"
    height="43"
    viewBox="0 0 42 43"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clipPath="url(#clip0)">
      <path
        d="M36.014 6.852 42.789 9.589c.124.05.23.136.305.247a.61.61 0 0 1 0 .647.61.61 0 0 1-.305.248L25.925 17.657a.697.697 0 0 1-.494 0l-7.666-3.096 18.25-7.709ZM10.905 13.209 5.029 10.836a.613.613 0 0 1 0-1.224l18.633-7.525a.697.697 0 0 1 .494 0l6.766 2.732-20.017 8.39Z"
        fill="#1E54F0"
      />
      <path
        d="M43.207 30.107v2.142a.61.61 0 0 1-.403.717l-18.23 7.888v-2.822l18.633-7.925Zm-38.597.13 18.633 7.974v2.543L5.014 32.866a.61.61 0 0 1-.404-.718v-2.012Zm0-1.46V10.211a.61.61 0 0 1 .914-.564l6.205 2.506v6.514a.61.61 0 0 0 .543.606l4.312 1.838a.697.697 0 0 0 .98-.624v-5.913l5.477 2.212v20.004L4.61 28.777Zm19.964 7.698V16.744l17.72-7.156a.61.61 0 0 1 .913.565v18.441l-18.633 7.881Z"
        fill="#1E54F0"
      />
      <path
        d="M24.574 17.309V16.744l17.72-7.156a.694.694 0 0 1 .494 0 .61.61 0 0 1 .305.248.61.61 0 0 1 .114.339.61.61 0 0 1-.115.338.61.61 0 0 1-.304.248l-16.864 6.82a.694.694 0 0 1-.494 0l-.856-.346Zm-1.331-.565v.028l-5.477-2.213 5.477 2.185ZM5.03 9.587a.694.694 0 0 1 .493 0l6.206 2.506v.768l-.824.347-5.875-2.373a.61.61 0 0 1-.419-.586.61.61 0 0 1 .419-.586Z"
        fill="#1E54F0"
      />
    </g>
    <defs>
      <clipPath id="clip0">
        <rect width="42" height="43" fill="white" />
      </clipPath>
    </defs>
  </svg>
);

const CountIcon = () => (
  <svg
    width="45"
    height="44"
    viewBox="0 0 45 44"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M29.8702 6.94531L14.0049 14.0846L21.2976 17.3664L37.1628 10.2269L29.8702 6.94531Z"
      fill="#EB8D0B"
    />
    <path
      d="M11.2383 12.2828L27.1912 4.98089L21.7343 2.48344C21.4881 2.37073 21.2217 2.3125 20.9524 2.3125C20.6831 2.3125 20.4167 2.37073 20.1705 2.48344L5.00023 9.42746L11.2383 12.2828ZM19.9876 18.4676L3.58398 10.959V30.5602C3.58404 30.946 3.69254 31.3235 3.89631 31.6469C4.10008 31.9703 4.39037 32.2257 4.73193 32.382L19.9875 39.3648L19.9876 18.4676ZM21.9173 31.928V39.3651L23.9848 38.4187C22.64 36.5399 21.9152 34.2645 21.9173 31.928ZM32.5314 20.966C34.5881 20.9642 36.6004 21.5834 38.3208 22.7474V10.959L21.9173 18.4676V31.928C21.9205 29.0217 23.0398 26.2354 25.0296 24.1804C27.0194 22.1253 29.7173 20.9693 32.5314 20.966Z"
      fill="#EB8D0B"
    />
    <path
      d="M33.1092 23.1562C35.4124 23.1562 37.6212 24.0716 39.2498 25.7002C40.8784 27.3288 41.7937 29.5376 41.7937 31.8408C41.7937 33.5583 41.284 35.237 40.3299 36.665C39.3756 38.0931 38.0192 39.206 36.4324 39.8633C34.8458 40.5204 33.1002 40.6924 31.4158 40.3574C29.7312 40.0223 28.1831 39.196 26.9686 37.9814C25.7541 36.7669 24.9277 35.2187 24.5926 33.5342C24.2576 31.8498 24.4296 30.1042 25.0867 28.5176C25.744 26.9308 26.8569 25.5743 28.285 24.6201C29.713 23.666 31.3917 23.1563 33.1092 23.1562ZM29.9998 35C29.4475 35 28.9998 35.4477 28.9998 36C28.9998 36.5523 29.4475 37 29.9998 37H35.9998C36.552 36.9999 36.9998 36.5522 36.9998 36C36.9998 35.4478 36.552 35.0001 35.9998 35H29.9998ZM27.9998 31C27.4475 31 26.9998 31.4477 26.9998 32C26.9998 32.5523 27.4475 33 27.9998 33H37.9998C38.552 32.9999 38.9998 32.5522 38.9998 32C38.9998 31.4478 38.552 31.0001 37.9998 31H27.9998ZM29.9998 27C29.4475 27 28.9998 27.4477 28.9998 28C28.9998 28.5523 29.4475 29 29.9998 29H35.9998C36.552 28.9999 36.9998 28.5522 36.9998 28C36.9998 27.4478 36.552 27.0001 35.9998 27H29.9998Z"
      fill="#EB8D0B"
    />
  </svg>
);

const RetailIcon = () => (
  <svg
    width="44"
    height="44"
    viewBox="0 0 44 44"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <path
      d="M41.2497 38.496H40.2184C40.1273 38.496 40.0398 38.4598 39.9754 38.3953C39.9109 38.3308 39.8747 38.2434 39.8747 38.1522V23.5007C39.8755 23.446 39.8632 23.392 39.8389 23.343C39.8145 23.294 39.7789 23.2515 39.7348 23.2191C39.6908 23.1866 39.6397 23.1652 39.5857 23.1565C39.5317 23.1478 39.4764 23.1521 39.4244 23.169C38.6358 23.4169 37.8169 23.5551 36.9906 23.5798C36.8892 23.5798 36.793 23.5841 36.6984 23.5841C35.1092 23.5878 33.5455 23.1843 32.1566 22.4119C32.0515 22.3534 31.9332 22.3228 31.8129 22.3228C31.6926 22.3228 31.5743 22.3534 31.4691 22.4119C30.0805 23.1843 28.5171 23.5878 26.9282 23.5841C25.3481 23.5863 23.7946 23.178 22.4199 22.399C22.3139 22.339 22.1941 22.3074 22.0723 22.3074C21.9505 22.3074 21.8307 22.339 21.7247 22.399C20.3293 23.1809 18.7557 23.5894 17.1562 23.585C15.5656 23.586 14.0023 23.1713 12.6213 22.3818C12.5145 22.321 12.3936 22.2891 12.2707 22.2891C12.1477 22.2891 12.0269 22.321 11.9201 22.3818C10.5391 23.1713 8.97581 23.586 7.38514 23.585C7.29147 23.585 7.19694 23.585 7.09553 23.5807H7.09038C6.23512 23.555 5.38787 23.4077 4.57413 23.1432C4.5226 23.1266 4.46786 23.1223 4.41438 23.1309C4.36089 23.1394 4.31018 23.1604 4.26637 23.1922C4.22255 23.2241 4.18688 23.2658 4.16226 23.314C4.13764 23.3623 4.12476 23.4156 4.12467 23.4698V38.1522C4.12467 38.2434 4.08846 38.3308 4.02399 38.3953C3.95953 38.4598 3.87209 38.496 3.78092 38.496H2.79264C2.05014 38.496 1.40905 39.0666 1.37639 39.8091C1.36803 39.9947 1.39736 40.18 1.4626 40.3539C1.52784 40.5278 1.62764 40.6867 1.75598 40.821C1.88432 40.9553 2.03854 41.0622 2.20932 41.1352C2.38011 41.2083 2.56392 41.2459 2.74967 41.246H41.2067C41.9492 41.246 42.5903 40.6754 42.623 39.9328C42.6313 39.7473 42.602 39.562 42.5368 39.388C42.4715 39.2141 42.3717 39.0552 42.2434 38.9209C42.115 38.7867 41.9608 38.6798 41.79 38.6067C41.6192 38.5337 41.4354 38.496 41.2497 38.496V38.496ZM19.2497 32.6522C19.2497 32.7434 19.2135 32.8308 19.149 32.8953C19.0845 32.9598 18.9971 32.996 18.9059 32.996H11.3434C11.2523 32.996 11.1648 32.9598 11.1004 32.8953C11.0359 32.8308 10.9997 32.7434 10.9997 32.6522V27.1522C10.9997 26.8787 11.1083 26.6164 11.3017 26.423C11.4951 26.2296 11.7574 26.121 12.0309 26.121H18.2184C18.4919 26.121 18.7542 26.2296 18.9476 26.423C19.141 26.6164 19.2497 26.8787 19.2497 27.1522V32.6522ZM32.6559 38.496H26.4684C26.3773 38.496 26.2898 38.4598 26.2254 38.3953C26.1609 38.3308 26.1247 38.2434 26.1247 38.1522V27.1522C26.1247 26.8787 26.2333 26.6164 26.4267 26.423C26.6201 26.2296 26.8824 26.121 27.1559 26.121H31.9684C32.2419 26.121 32.5042 26.2296 32.6976 26.423C32.891 26.6164 32.9997 26.8787 32.9997 27.1522V38.1522C32.9997 38.2434 32.9635 38.3308 32.899 38.3953C32.8345 38.4598 32.7471 38.496 32.6559 38.496Z"
      fill="#F01E22"
    />
    <path
      d="M42.3301 14.6334L38.6417 6.16945C37.6757 4.09234 35.4697 2.75 33.0213 2.75H10.9741C8.52573 2.75 6.31971 4.09234 5.35377 6.16945L1.66534 14.6334C0.891899 16.3015 1.9137 18.0142 1.91456 18.0151L1.93862 18.0538C1.98073 18.1208 2.05549 18.2256 2.10104 18.2927C2.10534 18.2978 2.10877 18.3038 2.11307 18.3098L2.54276 18.8298C2.55882 18.8494 2.57604 18.868 2.59432 18.8856L3.02401 19.3007L3.0601 19.3316C3.31244 19.5479 3.58236 19.7428 3.86706 19.9143V19.9186C4.80232 20.4851 5.86787 20.801 6.96081 20.8355C7.03127 20.8355 7.10174 20.8355 7.17307 20.8355C8.82674 20.8386 10.4202 20.215 11.6324 19.0902L11.6607 19.0635C11.7873 18.9442 11.9547 18.8778 12.1287 18.8778C12.3026 18.8778 12.47 18.9442 12.5966 19.0635L12.6249 19.0902C13.8501 20.2131 15.4516 20.836 17.1135 20.836C18.7753 20.836 20.3768 20.2131 21.602 19.0902C21.7291 18.9725 21.8959 18.9071 22.069 18.9071C22.2422 18.9071 22.409 18.9725 22.5361 19.0902V19.0902C23.7576 20.2095 25.3533 20.8321 27.0101 20.8357C28.6669 20.8394 30.2652 20.2239 31.4917 19.1099C31.6169 18.994 31.7812 18.9295 31.9519 18.9295C32.1225 18.9295 32.2869 18.994 32.4121 19.1099C33.6398 20.2307 35.2451 20.8469 36.9074 20.8355H37.1214C38.1869 20.7958 39.2236 20.4788 40.1292 19.916V19.916C40.2109 19.867 40.2891 19.8155 40.3681 19.7639C40.9789 19.3522 41.5105 18.8337 41.9374 18.2334L42.0869 18.0073C42.1018 17.9844 42.1155 17.9604 42.1281 17.9352C42.2708 17.6447 43.0356 16.1511 42.3301 14.6334Z"
      fill="#F01E22"
    />
  </svg>
);

const Count = () => (
  <svg
    width="42"
    height="43"
    viewBox="0 0 42 43"
    fill="none"
    xmlns="http://www.w3.org/2000/svg"
  >
    <g clip-path="url(#clip0_1110_716)">
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M36.0138 6.85245L42.7888 9.58899C42.9127 9.63845 43.0189 9.72435 43.0938 9.83553C43.1686 9.94672 43.2086 10.0781 43.2086 10.2125C43.2086 10.3469 43.1686 10.4783 43.0938 10.5894C43.0189 10.7006 42.9127 10.7865 42.7888 10.836L25.9254 17.6569C25.7666 17.7207 25.5897 17.7207 25.4309 17.6569L17.7655 14.5609L36.0138 6.85245ZM10.9045 13.2091L5.02916 10.836C4.90535 10.7865 4.79912 10.7006 4.72426 10.5894C4.6494 10.4783 4.60938 10.3469 4.60938 10.2125C4.60938 10.0781 4.6494 9.94672 4.72426 9.83553C4.79912 9.72435 4.90535 9.63845 5.02916 9.58899L23.6621 2.06399C23.8205 1.9995 23.9975 1.9995 24.1559 2.06399L30.9216 4.79584L10.9045 13.2091Z"
        fill="#24CA0E"
      />
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M43.2072 30.1074V32.2487C43.2072 32.5174 43.0488 32.7606 42.8039 32.8661L24.5742 40.7539V37.932L43.2072 30.1074ZM4.61035 30.2371L23.2433 38.2109V40.7539L5.01362 32.8661C4.89389 32.8144 4.79185 32.7283 4.72015 32.6185C4.64846 32.5088 4.61028 32.3801 4.61035 32.2487V30.2371ZM4.61035 28.7771V10.2112C4.61058 10.1015 4.63737 9.99352 4.6884 9.89669C4.73942 9.79986 4.81312 9.7171 4.90309 9.65562C4.99305 9.59414 5.09654 9.5558 5.20454 9.54396C5.31253 9.53211 5.42176 9.54712 5.5227 9.58766L11.7288 12.0938V18.6076C11.7288 18.8824 11.9438 19.1296 12.2712 19.2317L16.5834 21.0693C16.85 21.1519 17.1379 21.1276 17.3872 21.0015C17.6241 20.8765 17.7659 20.6682 17.7659 20.4452V14.532L23.2433 16.7438V36.7482L4.61035 28.7771ZM24.5742 36.4754V16.7438L42.2948 9.58766C42.3958 9.5466 42.5051 9.5312 42.6133 9.54283C42.7215 9.55445 42.8252 9.59273 42.9153 9.65431C43.0054 9.71589 43.0792 9.79887 43.1301 9.89597C43.181 9.99307 43.2074 10.1013 43.2072 10.2112V28.6521L24.5742 36.4754Z"
        fill="#24CA0E"
      />
      <path
        fill-rule="evenodd"
        clip-rule="evenodd"
        d="M24.5742 17.3094V16.7437L42.2948 9.58753C42.453 9.52314 42.6296 9.5229 42.7879 9.58685L42.8046 9.59357L42.8092 9.59559L42.8252 9.60298L42.8445 9.61306L42.8631 9.62246L42.8798 9.63254L42.8977 9.64329L42.9084 9.65001L42.917 9.65673L42.927 9.66345L42.9357 9.66949L42.9457 9.67688L42.9543 9.6836L42.963 9.69099L42.9796 9.7051L42.9962 9.72056L43.0029 9.7266L43.0129 9.73668L43.0189 9.74273L43.0288 9.75348L43.0348 9.75953L43.0448 9.77162L43.0495 9.77699L43.0648 9.79514L43.0774 9.8126L43.0814 9.81798L43.0907 9.83142L43.0954 9.83814L43.1034 9.8509L43.1074 9.85762L43.1193 9.8771L43.13 9.89659L43.14 9.91674L43.144 9.92548L43.1493 9.93757L43.1533 9.94698L43.1586 9.9584L43.1619 9.96781L43.1699 9.98931L43.1766 10.0095L43.1792 10.0195L43.1832 10.0316L43.1859 10.0417L43.1886 10.0538L43.1912 10.0646L43.1939 10.0773L43.1959 10.0874L43.1992 10.1076L43.2025 10.1297L43.2045 10.1492L43.2059 10.17L43.2065 10.1889L43.2072 10.211C43.2073 10.3453 43.1674 10.4766 43.0928 10.5877C43.0182 10.6989 42.9122 10.7849 42.7886 10.8345L25.9251 17.6554C25.7664 17.7192 25.5894 17.7192 25.4307 17.6554L24.5742 17.3094ZM23.2433 16.7437V16.7719L17.7659 14.5594L17.7992 14.5453L23.2433 16.7437ZM5.02959 9.58685C5.1879 9.5229 5.36456 9.52314 5.5227 9.58753L11.7288 12.0936V12.8609L10.9043 13.2076L5.02893 10.8345C4.90534 10.7849 4.79936 10.6989 4.72473 10.5877C4.6501 10.4766 4.61026 10.3453 4.61035 10.211L4.61102 10.1889L4.61168 10.17L4.61301 10.1485L4.61568 10.127L4.61834 10.1076L4.62166 10.0874L4.62366 10.0773L4.62632 10.0646L4.62898 10.0538L4.63165 10.0417L4.63431 10.0316L4.6383 10.0195L4.64096 10.0095L4.64762 9.98931L4.6556 9.96781L4.65893 9.9584L4.66425 9.94698L4.66825 9.93757L4.67357 9.92548L4.67756 9.91674L4.68755 9.89659L4.69819 9.8771L4.71017 9.85762L4.71416 9.8509L4.72215 9.83814L4.72681 9.83142L4.73612 9.81798L4.74012 9.8126L4.75343 9.79446L4.76807 9.77699L4.77272 9.77162L4.78271 9.75953L4.7887 9.75348L4.79868 9.74273L4.80467 9.73668L4.81465 9.7266L4.8213 9.72056L4.83794 9.7051L4.85458 9.69099L4.86323 9.6836L4.87188 9.67688L4.88186 9.66949L4.89051 9.66345L4.90049 9.65673L4.90914 9.65001L4.91979 9.64329L4.93776 9.63254L4.95639 9.62179L4.97303 9.61306L4.99233 9.60298L5.0083 9.59559L5.01296 9.59357L5.02959 9.58685Z"
        fill="#24CA0E"
      />
    </g>
    <defs>
      <clipPath id="clip0_1110_716">
        <rect width="42" height="43" fill="white" />
      </clipPath>
    </defs>
  </svg>
);
